// <auto-generated>
// This file was generated by ModularPipelines.OptionsGenerator on 2025-12-08.
// Source: https://cloud.google.com/sdk/gcloud/reference/compute/security-policies/rules/update
// Do not edit this file manually.
// </auto-generated>

#nullable enable

using System.Diagnostics.CodeAnalysis;
using ModularPipelines.Attributes;
using ModularPipelines.Google.Options;
using ModularPipelines.Google.Enums;

namespace ModularPipelines.Google.Options;

/// <summary>
/// update a Compute Engine      security policy rule
/// </summary>
[ExcludeFromCodeCoverage]
[CliSubCommand("compute", "security-policies", "rules", "update")]
public record GcloudComputeSecurityPoliciesRulesUpdateOptions(
    [property: CliArgument(0, Name = "PRIORITY")] string Priority
) : GcloudOptions
{
    /// <summary>
    /// The action to take if the request matches the match condition. ACTION      must be one of:        allow        Allows the request from HTTP(S) Load Balancing.      deny        Denies the request from TCP/SSL Proxy and Network Load Balancing.      deny-403        Denies the request from HTTP(S) Load Balancing, with an HTTP        response status code of 403.      deny-404        Denies the request from HTTP(S) Load Balancing, with an HTTP        response status code of 404.      deny-502        Denies the request from HTTP(S) Load Balancing, with an HTTP        response status code of 502.      rate-based-ban        Enforces rate-based ban action from HTTP(S) Load Balancing, based        on rate limit options.      redirect        Redirects the request from HTTP(S) Load Balancing, based on        redirect options.      redirect-to-recaptcha        (DEPRECATED) Redirects the request from HTTP(S) Load Balancing, for        reCAPTCHA Enterprise assessment. This flag choice is deprecated.        Use --action=redirect and --redirect-type=google-recaptcha instead.      throttle        Enforces throttle action from HTTP(S) Load Balancing, based on rate        limit options.
    /// </summary>
    [CliOption("--action", Format = OptionFormat.EqualsSeparated)]
    public string? Action { get; set; }

    /// <summary>
    /// Can only be specified if the action for the rule is rate-based-ban. If      specified, determines the time (in seconds) the traffic will continue      to be banned by the rate limit after the rate falls below the      threshold.
    /// </summary>
    [CliOption("--ban-duration-sec", Format = OptionFormat.EqualsSeparated)]
    public string? BanDurationSec { get; set; }

    /// <summary>
    /// Number of HTTP(S) requests for calculating the threshold for banning      requests. Can only be specified if the action for the rule is      rate-based-ban. If specified, the key will be banned for the configured      BAN_DURATION_SEC when the number of requests that exceed the      RATE_LIMIT_THRESHOLD_COUNT also exceed this BAN_THRESHOLD_COUNT.
    /// </summary>
    [CliOption("--ban-threshold-count", Format = OptionFormat.EqualsSeparated)]
    public int? BanThresholdCount { get; set; }

    /// <summary>
    /// Interval over which the threshold for banning requests is computed. Can      only be specified if the action for the rule is rate-based-ban. If      specified, the key will be banned for the configured BAN_DURATION_SEC      when the number of requests that exceed the RATE_LIMIT_THRESHOLD_COUNT      also exceed this BAN_THRESHOLD_COUNT.
    /// </summary>
    [CliOption("--ban-threshold-interval-sec", Format = OptionFormat.EqualsSeparated)]
    public string? BanThresholdIntervalSec { get; set; }

    /// <summary>
    /// Action to take when requests are under the given threshold. When      requests are throttled, this is also the action for all requests which      are not dropped. CONFORM_ACTION must be (only one value is supported):      allow.
    /// </summary>
    [CliOption("--conform-action", Format = OptionFormat.EqualsSeparated)]
    public string? ConformAction { get; set; }

    /// <summary>
    /// An optional, textual description for the rule.
    /// </summary>
    [CliOption("--description", Format = OptionFormat.EqualsSeparated)]
    public string? Description { get; set; }

    /// <summary>
    /// Different key types available to enforce the rate limit threshold limit      on:      * ip: each client IP address has this limit enforced separately      * all: a single limit is applied to all requests matching this rule      * http-header: key type takes the value of the HTTP header configured       in enforce-on-key-name as the key value      * xff-ip: takes the original IP address specified in the       X-Forwarded-For header as the key      * http-cookie: key type takes the value of the HTTP cookie configured       in enforce-on-key-name as the key value      * http-path: key type takes the value of the URL path in the request      * sni: key type takes the value of the server name indication from       the TLS session of the HTTPS request      * region-code: key type takes the value of the region code from which       the request originates      * tls-ja3-fingerprint: key type takes the value of JA3 TLS/SSL       fingerprint if the client connects using HTTPS, HTTP/2 or HTTP/3      * user-ip: key type takes the IP address of the originating client,       which is resolved based on user-ip-request-headers configured with       the security policy      * tls-ja4-fingerprint: key type takes the value of JA4 TLS/SSL       fingerprint if the client connects using HTTPS, HTTP/2 or HTTP/3        ENFORCE_ON_KEY must be one of: ip, all, http-header, xff-ip,      http-cookie, http-path, sni, region-code, tls-ja3-fingerprint, user-ip,      tls-ja4-fingerprint.
    /// </summary>
    [CliOption("--enforce-on-key", Format = OptionFormat.EqualsSeparated)]
    public GcloudEnforceOnKey? EnforceOnKey { get; set; }

    /// <summary>
    /// Specify up to 3 key type/name pairs to rate limit. Valid key types are:        * ip: each client IP address has this limit enforced separately      * all: a single limit is applied to all requests matching this rule      * http-header: key type takes the value of the HTTP header configured       in enforce-on-key-name as the key value      * xff-ip: takes the original IP address specified in the       X-Forwarded-For header as the key      * http-cookie: key type takes the value of the HTTP cookie configured       in enforce-on-key-name as the key value      * http-path: key type takes the value of the URL path in the request      * sni: key type takes the value of the server name indication from       the TLS session of the HTTPS request      * region-code: key type takes the value of the region code from which       the request originates      * tls-ja3-fingerprint: key type takes the value of JA3 TLS/SSL       fingerprint if the client connects using HTTPS, HTTP/2 or HTTP/3      * user-ip: key type takes the IP address of the originating client,       which is resolved based on user-ip-request-headers configured with       the security policy      * tls-ja4-fingerprint: key type takes the value of JA4 TLS/SSL       fingerprint if the client connects using HTTPS, HTTP/2 or HTTP/3        Key names are only applicable to the following key types:      * http-header: The name of the HTTP header whose value is taken as       the key value.      * http-cookie: The name of the HTTP cookie whose value is taken as       the key value.
    /// </summary>
    [CliOption("--enforce-on-key-configs", Format = OptionFormat.EqualsSeparated, AllowMultiple = true)]
    public IEnumerable<string>? EnforceOnKeyConfigs { get; set; }

    /// <summary>
    /// Determines the key name for the rate limit key. Applicable only for the      following rate limit key types:      * http-header: The name of the HTTP header whose value is taken as       the key value.      * http-cookie: The name of the HTTP cookie whose value is taken as       the key value.
    /// </summary>
    [CliOption("--enforce-on-key-name", Format = OptionFormat.EqualsSeparated)]
    public string? EnforceOnKeyName { get; set; }

    /// <summary>
    /// Action to take when requests are above the given threshold. When a      request is denied, return the specified HTTP response code. When a      request is redirected, use the redirect options based on      --exceed-redirect-type and --exceed-redirect-target below.      EXCEED_ACTION must be one of: deny-403, deny-404, deny-429, deny-502,      deny, redirect.
    /// </summary>
    [CliOption("--exceed-action", Format = OptionFormat.EqualsSeparated)]
    public GcloudExceedAction? ExceedAction { get; set; }

    /// <summary>
    /// URL target for the redirect action that is configured as the exceed      action when the redirect type is external-302.
    /// </summary>
    [CliOption("--exceed-redirect-target", Format = OptionFormat.EqualsSeparated)]
    public string? ExceedRedirectTarget { get; set; }

    /// <summary>
    /// Type for the redirect action that is configured as the exceed action.      EXCEED_REDIRECT_TYPE must be one of: google-recaptcha, external-302.
    /// </summary>
    [CliOption("--exceed-redirect-type", Format = OptionFormat.EqualsSeparated)]
    public GcloudExceedRedirectType? ExceedRedirectType { get; set; }

    /// <summary>
    /// Number of HTTP(S) requests for calculating the threshold for rate      limiting requests.
    /// </summary>
    [CliOption("--rate-limit-threshold-count", Format = OptionFormat.EqualsSeparated)]
    public int? RateLimitThresholdCount { get; set; }

    /// <summary>
    /// Interval over which the threshold for rate limiting requests is      computed.
    /// </summary>
    [CliOption("--rate-limit-threshold-interval-sec", Format = OptionFormat.EqualsSeparated)]
    public string? RateLimitThresholdIntervalSec { get; set; }

    /// <summary>
    /// A comma-separated list of site keys to be used during the validation of      reCAPTCHA action-tokens. The provided site keys need to be created from      the reCAPTCHA API under the same project where the security policy is      created.
    /// </summary>
    [CliOption("--recaptcha-action-site-keys", Format = OptionFormat.EqualsSeparated, AllowMultiple = true)]
    public IEnumerable<string>? RecaptchaActionSiteKeys { get; set; }

    /// <summary>
    /// A comma-separated list of site keys to be used during the validation of      reCAPTCHA session-tokens. The provided site keys need to be created      from the reCAPTCHA API under the same project where the security policy      is created.
    /// </summary>
    [CliOption("--recaptcha-session-site-keys", Format = OptionFormat.EqualsSeparated, AllowMultiple = true)]
    public IEnumerable<string>? RecaptchaSessionSiteKeys { get; set; }

    /// <summary>
    /// URL target for the redirect action. Must be specified if the redirect      type is external-302. Cannot be specified if the redirect type is      google-recaptcha.
    /// </summary>
    [CliOption("--redirect-target", Format = OptionFormat.EqualsSeparated)]
    public string? RedirectTarget { get; set; }

    /// <summary>
    /// Type for the redirect action. Default to external-302 if unspecified      while --redirect-target is given. REDIRECT_TYPE must be one of:      google-recaptcha, external-302.
    /// </summary>
    [CliOption("--redirect-type", Format = OptionFormat.EqualsSeparated)]
    public GcloudRedirectType? RedirectType { get; set; }

    /// <summary>
    /// Region of the security policy to update. If not specified, you might be      prompted to select a region (interactive mode only).        A list of regions can be fetched by running:          $ gcloud compute regions list        Overrides the default compute/region property value for this command      invocation.
    /// </summary>
    [CliOption("--region", Format = OptionFormat.EqualsSeparated)]
    public string? Region { get; set; }

    /// <summary>
    /// A comma-separated list of header names and header values to add to      requests that match this rule.
    /// </summary>
    [CliOption("--request-headers-to-add", Format = OptionFormat.EqualsSeparated, AllowMultiple = true)]
    public IEnumerable<string>? RequestHeadersToAdd { get; set; }

    /// <summary>
    /// The security policy that this rule belongs to.      Security policy rule matcher.       --expression=EXPRESSION       The Cloud Armor rules language expression to match for this rule.       --network-dest-ip-ranges=[DEST_IP_RANGE,...]       The destination IPs/IP ranges to match for this rule. To match all       IPs specify *.       --network-dest-ports=[DEST_PORT,...]       The destination ports to match for this rule. Each element can be an       16-bit unsigned decimal number (e.g. "80") or range (e.g."0-1023"),       To match all destination ports specify *.       --network-ip-protocols=[IP_PROTOCOL,...]       The IP protocols to match for this rule. Each element can be an 8-bit       unsigned decimal number (e.g. "6"), range (e.g."253-254"), or one of       the following protocol names: "tcp", "udp", "icmp", "esp", "ah",       "ipip", or "sctp". To match all protocols specify *.       --network-src-asns=[SRC_ASN,...]       BGP Autonomous System Number associated with the source IP address to       match for this rule.       --network-src-ip-ranges=[SRC_IP_RANGE,...]       The source IPs/IP ranges to match for this rule. To match all IPs       specify *.       --network-src-ports=[SRC_PORT,...]       The source ports to match for this rule. Each element can be an       16-bit unsigned decimal number (e.g. "80") or range (e.g."0-1023"),       To match all source ports specify *.       --network-src-region-codes=[SRC_REGION_CODE,...]       The two letter ISO 3166-1 alpha-2 country code associated with the       source IP address to match for this rule. To match all region codes       specify *.       --network-user-defined-fields=[NAME;VALUE:VALUE:...,...]       Each element names a defined field and lists the matching values for       that field.       --src-ip-ranges=[SRC_IP_RANGE,...]       The source IPs/IP ranges to match for this rule. To match all IPs       specify *.
    /// </summary>
    [CliOption("--security-policy", Format = OptionFormat.EqualsSeparated)]
    public string? SecurityPolicy { get; set; }

}
