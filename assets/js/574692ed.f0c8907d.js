"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[9395],{8302:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>g,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"how-to/logging","title":"Logging","description":"IModuleLogger","source":"@site/docs/how-to/logging.md","sourceDirName":"how-to","slug":"/how-to/logging","permalink":"/ModularPipelines/docs/how-to/logging","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"title":"Logging","sidebar_position":8},"sidebar":"tutorialSidebar","previous":{"title":"Skipping Modules","permalink":"/ModularPipelines/docs/how-to/skipping"},"next":{"title":"Testing","permalink":"/ModularPipelines/docs/how-to/testing"}}');var t=o(4848),r=o(8453);const l={title:"Logging",sidebar_position:8},s="Logging",d={},a=[{value:"IModuleLogger",id:"imodulelogger",level:2},{value:"Secret Obfuscation",id:"secret-obfuscation",level:2},{value:"Grouped Logs",id:"grouped-logs",level:2},{value:"Interfering with Console Progress",id:"interfering-with-console-progress",level:2},{value:"Analyzers",id:"analyzers",level:2},{value:"How to access IModuleLogger",id:"how-to-access-imodulelogger",level:2},{value:"Module",id:"module",level:3},{value:"Elsewhere",id:"elsewhere",level:3},{value:"Command Logging",id:"command-logging",level:2},{value:"Verbosity Levels",id:"verbosity-levels",level:3},{value:"Per-Command Configuration",id:"per-command-configuration",level:3},{value:"Global Defaults",id:"global-defaults",level:3},{value:"Using Presets",id:"using-presets",level:3},{value:"Fine-Grained Control",id:"fine-grained-control",level:3},{value:"Output Manipulators",id:"output-manipulators",level:3},{value:"Configuration Precedence",id:"configuration-precedence",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"logging",children:"Logging"})}),"\n",(0,t.jsx)(n.h2,{id:"imodulelogger",children:"IModuleLogger"}),"\n",(0,t.jsxs)(n.p,{children:["When logging in your pipeline, you should always use an IModuleLogger. Do not inject in your own ILogger, and do not write to the console directly using the ",(0,t.jsx)(n.code,{children:"Console"})," class, or any other class that would write directly to the console."]}),"\n",(0,t.jsxs)(n.p,{children:["This is because the ",(0,t.jsx)(n.code,{children:"IModuleLogger"})," will perform many actions that will improve the output of your logs."]}),"\n",(0,t.jsx)(n.p,{children:"These are detailed below."}),"\n",(0,t.jsx)(n.h2,{id:"secret-obfuscation",children:"Secret Obfuscation"}),"\n",(0,t.jsxs)(n.p,{children:["If secrets have been defined (See ",(0,t.jsx)(n.a,{href:"secrets",children:"Secrets"})," for details on this), then if any of them are attempted to be written to logs via IModuleLogger, either directly, or through things like HTTP or Command logs, they will be obfuscated in the output. So for instance, if you made a HTTP call with a bearer token of 'MySuperSecretToken', when the HTTP request is logged, that bearer will show as '**********'."]}),"\n",(0,t.jsx)(n.h2,{id:"grouped-logs",children:"Grouped Logs"}),"\n",(0,t.jsx)(n.p,{children:"When writing logs through IModuleLogger, logs will be grouped by what module they're in.\nSince all modules attempt to run in parallel, if there was no log organisation, then logs would be everywhere and all jumbled up, and hard to navigate. This keeps logs together, clean, and easy to read. This is why it's very important not to write to the console directly, as that'll prevent this from working."}),"\n",(0,t.jsx)(n.h2,{id:"interfering-with-console-progress",children:"Interfering with Console Progress"}),"\n",(0,t.jsx)(n.p,{children:"If you have an interactive terminal, then a progress dialog will be displayed, and constantly updated with the progress of all your modules.\nIf you start writing to the console directly, then you'll be writing over the top of this progress dialog and messing up how it renders."}),"\n",(0,t.jsx)(n.h2,{id:"analyzers",children:"Analyzers"}),"\n",(0,t.jsxs)(n.p,{children:["If you forget the above, Modular Pipelines has analyzers built as part of its framework. It'll detect direct uses of ",(0,t.jsx)(n.code,{children:"Console"}),", or trying to inject in custom ",(0,t.jsx)(n.code,{children:"ILogger"}),"s and will result in errors, asking you to fix the issues."]}),"\n",(0,t.jsx)(n.h2,{id:"how-to-access-imodulelogger",children:"How to access IModuleLogger"}),"\n",(0,t.jsx)(n.h3,{id:"module",children:"Module"}),"\n",(0,t.jsxs)(n.p,{children:["If you're in a module, it's part of your ",(0,t.jsx)(n.code,{children:"context"})," object. Call ",(0,t.jsx)(n.code,{children:"context.Logger"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"elsewhere",children:"Elsewhere"}),"\n",(0,t.jsxs)(n.p,{children:["If you're in another class, you can inject in ",(0,t.jsx)(n.code,{children:"IModuleLoggerProvider"})," and call ",(0,t.jsx)(n.code,{children:"GetLogger"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"command-logging",children:"Command Logging"}),"\n",(0,t.jsxs)(n.p,{children:["When you execute CLI commands (e.g., ",(0,t.jsx)(n.code,{children:"dotnet build"}),", ",(0,t.jsx)(n.code,{children:"docker run"}),"), ModularPipelines logs the command execution details. You can control what gets logged using ",(0,t.jsx)(n.code,{children:"CommandLoggingOptions"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"verbosity-levels",children:"Verbosity Levels"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Level"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Silent"})}),(0,t.jsx)(n.td,{children:"No output at all"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Minimal"})}),(0,t.jsx)(n.td,{children:"Only command input (no output/errors)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Normal"})}),(0,t.jsx)(n.td,{children:"Input, output, and errors on failure (default)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Detailed"})}),(0,t.jsx)(n.td,{children:"Above plus exit code and duration"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Diagnostic"})}),(0,t.jsx)(n.td,{children:"Everything including working directory and timestamps"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"per-command-configuration",children:"Per-Command Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'await context.DotNet().Build(\n    new DotNetBuildOptions { Configuration = "Release" },\n    new CommandExecutionOptions\n    {\n        LogSettings = new CommandLoggingOptions\n        {\n            Verbosity = CommandLogVerbosity.Detailed\n        }\n    });\n'})}),"\n",(0,t.jsx)(n.h3,{id:"global-defaults",children:"Global Defaults"}),"\n",(0,t.jsx)(n.p,{children:"Set default logging for all commands at the pipeline level:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"var builder = Pipeline.CreateBuilder(args);\n\n// All commands will use Silent logging unless overridden\nbuilder.Options.DefaultLoggingOptions = CommandLoggingOptions.Silent;\n\n// Or use Diagnostic for debugging\nbuilder.Options.DefaultLoggingOptions = CommandLoggingOptions.Diagnostic;\n\nawait builder.Build().RunAsync();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"using-presets",children:"Using Presets"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"// Silent - no command logging\nnew CommandExecutionOptions { LogSettings = CommandLoggingOptions.Silent }\n\n// Diagnostic - maximum verbosity\nnew CommandExecutionOptions { LogSettings = CommandLoggingOptions.Diagnostic }\n\n// Default - normal verbosity\nnew CommandExecutionOptions { LogSettings = CommandLoggingOptions.Default }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"fine-grained-control",children:"Fine-Grained Control"}),"\n",(0,t.jsx)(n.p,{children:"Override individual settings regardless of verbosity level:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"new CommandLoggingOptions\n{\n    Verbosity = CommandLogVerbosity.Normal,\n    ShowCommandArguments = true,\n    ShowStandardOutput = true,\n    ShowStandardError = true,\n    ShowExitCode = true,\n    ShowExecutionTime = true,\n    ShowWorkingDirectory = false,\n    IncludeTimestamps = false\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"output-manipulators",children:"Output Manipulators"}),"\n",(0,t.jsx)(n.p,{children:"Transform logged content before it's written (useful for truncating large outputs or redacting sensitive data):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'new CommandExecutionOptions\n{\n    LogSettings = new CommandLoggingOptions { Verbosity = CommandLogVerbosity.Normal },\n    InputLoggingManipulator = input => input.Length > 500\n        ? input.Substring(0, 500) + "... (truncated)"\n        : input,\n    OutputLoggingManipulator = output => output.Replace("api-key-value", "***")\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"configuration-precedence",children:"Configuration Precedence"}),"\n",(0,t.jsx)(n.p,{children:"Logging settings are resolved in this order (highest to lowest priority):"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Per-Call"}),": ",(0,t.jsx)(n.code,{children:"CommandExecutionOptions.LogSettings"})," on individual command calls"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Global Default"}),": ",(0,t.jsx)(n.code,{children:"builder.Options.DefaultLoggingOptions"})," set at pipeline level"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"System Default"}),": ",(0,t.jsx)(n.code,{children:"CommandLoggingOptions.Default"})," (Normal verbosity)"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>l,x:()=>s});var i=o(6540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);