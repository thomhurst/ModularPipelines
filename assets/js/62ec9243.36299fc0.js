"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7793],{1858:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>s,contentTitle:()=>d,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"how-to/migrating-to-v3","title":"Migrating to V3","description":"ModularPipelines V3 is a major release that modernizes the API to follow ASP.NET Core minimal API patterns. This guide covers all breaking changes and how to migrate your existing pipelines.","source":"@site/docs/how-to/migrating-to-v3.md","sourceDirName":"how-to","slug":"/how-to/migrating-to-v3","permalink":"/ModularPipelines/docs/how-to/migrating-to-v3","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":99,"frontMatter":{"title":"Migrating to V3","sidebar_position":99},"sidebar":"tutorialSidebar","previous":{"title":"Testing","permalink":"/ModularPipelines/docs/how-to/testing"},"next":{"title":"Always Run","permalink":"/ModularPipelines/docs/how-to/always-run"}}');var l=i(4848),r=i(8453);const o={title:"Migrating to V3",sidebar_position:99},d="Migrating from V2 to V3",s={},c=[{value:"Quick Migration Checklist",id:"quick-migration-checklist",level:2},{value:"Entry Point Changes",id:"entry-point-changes",level:2},{value:"Before (V2)",id:"before-v2",level:3},{value:"After (V3)",id:"after-v3",level:3},{value:"Key Differences",id:"key-differences",level:3},{value:"Compatibility Note",id:"compatibility-note",level:3},{value:"Module Behavior Changes",id:"module-behavior-changes",level:2},{value:"Before (V2)",id:"before-v2-1",level:3},{value:"After (V3)",id:"after-v3-1",level:3},{value:"Migration Mapping",id:"migration-mapping",level:3},{value:"Alternative: Lifecycle Hook Overrides",id:"alternative-lifecycle-hook-overrides",level:3},{value:"Context Parameter Change",id:"context-parameter-change",level:2},{value:"Before (V2)",id:"before-v2-2",level:3},{value:"After (V3)",id:"after-v3-2",level:3},{value:"Command Execution Options",id:"command-execution-options",level:2},{value:"Before (V2)",id:"before-v2-3",level:3},{value:"After (V3)",id:"after-v3-3",level:3},{value:"Migration Mapping",id:"migration-mapping-1",level:3},{value:"Benefits",id:"benefits",level:3},{value:"Getting Module Results",id:"getting-module-results",level:2},{value:"Before (V2)",id:"before-v2-4",level:3},{value:"After (V3)",id:"after-v3-4",level:3},{value:"Alternative Result Access Patterns",id:"alternative-result-access-patterns",level:3},{value:"Key Change Summary",id:"key-change-summary",level:3},{value:"Result Type Quick Reference",id:"result-type-quick-reference",level:3},{value:"Deleted Types and Members",id:"deleted-types-and-members",level:2},{value:"New Features in V3",id:"new-features-in-v3",level:2},{value:"Non-Generic Module Classes",id:"non-generic-module-classes",level:3},{value:"Pipeline Validation",id:"pipeline-validation",level:3},{value:"Dynamic Dependencies",id:"dynamic-dependencies",level:3},{value:"New Dependency Attributes",id:"new-dependency-attributes",level:3},{value:"Conditional Execution Attributes",id:"conditional-execution-attributes",level:3},{value:"Module Tags",id:"module-tags",level:3},{value:"Plugin System",id:"plugin-system",level:3},{value:"Complete Migration Example",id:"complete-migration-example",level:2},{value:"Before (V2)",id:"before-v2-5",level:3},{value:"After (V3)",id:"after-v3-5",level:3},{value:"Breaking API Reference",id:"breaking-api-reference",level:2},{value:"LLM/AI Migration Reference",id:"llmai-migration-reference",level:2},{value:"Complete API Transformation Map",id:"complete-api-transformation-map",level:3},{value:"Common Compiler Errors and Fixes",id:"common-compiler-errors-and-fixes",level:3},{value:"Regex Patterns for Automated Migration",id:"regex-patterns-for-automated-migration",level:3},{value:"V3 Module Template",id:"v3-module-template",level:3},{value:"V3 Result Handling Patterns",id:"v3-result-handling-patterns",level:3},{value:"V3 Command Execution Pattern",id:"v3-command-execution-pattern",level:3},{value:"Keywords for Search",id:"keywords-for-search",level:3},{value:"Getting Help",id:"getting-help",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"migrating-from-v2-to-v3",children:"Migrating from V2 to V3"})}),"\n",(0,l.jsx)(n.p,{children:"ModularPipelines V3 is a major release that modernizes the API to follow ASP.NET Core minimal API patterns. This guide covers all breaking changes and how to migrate your existing pipelines."}),"\n",(0,l.jsx)(n.h2,{id:"quick-migration-checklist",children:"Quick Migration Checklist"}),"\n",(0,l.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Replace ",(0,l.jsx)(n.code,{children:"PipelineHostBuilder.Create()"})," with ",(0,l.jsx)(n.code,{children:"Pipeline.CreateBuilder(args)"})]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Replace callback-based configuration with direct property access"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Change ",(0,l.jsx)(n.code,{children:"IPipelineContext"})," to ",(0,l.jsx)(n.code,{children:"IModuleContext"})," in ",(0,l.jsx)(n.code,{children:"ExecuteAsync"})," signatures"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Update ",(0,l.jsx)(n.code,{children:"GetModule<T>()"})," calls to ",(0,l.jsx)(n.code,{children:"context.GetModule<T>()"})," (method moved to context)"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Migrate virtual property overrides to ",(0,l.jsx)(n.code,{children:"Configure()"})," builder"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Update result access patterns to use pattern matching or ",(0,l.jsx)(n.code,{children:"ValueOrDefault"})]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Move ",(0,l.jsx)(n.code,{children:"WorkingDirectory"}),", ",(0,l.jsx)(n.code,{children:"EnvironmentVariables"}),", etc. from tool options to ",(0,l.jsx)(n.code,{children:"CommandExecutionOptions"})]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"entry-point-changes",children:"Entry Point Changes"}),"\n",(0,l.jsx)(n.p,{children:"The pipeline entry point has been completely redesigned to match ASP.NET Core's minimal API pattern."}),"\n",(0,l.jsx)(n.h3,{id:"before-v2",children:"Before (V2)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'await PipelineHostBuilder.Create()\n    .ConfigureAppConfiguration((context, builder) =>\n    {\n        builder.AddJsonFile("appsettings.json")\n            .AddUserSecrets<Program>()\n            .AddEnvironmentVariables();\n    })\n    .ConfigureServices((context, collection) =>\n    {\n        collection.Configure<MySettings>(context.Configuration.GetSection("MySettings"));\n\n        if (context.HostingEnvironment.IsDevelopment())\n        {\n            collection.AddModule<DevModule>();\n        }\n\n        collection.AddModule<BuildModule>();\n    })\n    .ConfigurePipelineOptions((context, options) =>\n    {\n        options.ExecutionMode = ExecutionMode.StopOnFirstException;\n    })\n    .AddModule<TestModule>()\n    .AddModule<DeployModule>()\n    .ExecutePipelineAsync();\n'})}),"\n",(0,l.jsx)(n.h3,{id:"after-v3",children:"After (V3)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'var builder = Pipeline.CreateBuilder(args);\n\n// Direct property access instead of callbacks\nbuilder.Configuration\n    .AddJsonFile("appsettings.json")\n    .AddUserSecrets<Program>()\n    .AddEnvironmentVariables();\n\n// Configure services directly\nbuilder.Services.Configure<MySettings>(builder.Configuration.GetSection("MySettings"));\n\nif (builder.Environment.IsDevelopment())\n{\n    builder.Services.AddModule<DevModule>();\n}\n\nbuilder.Services\n    .AddModule<BuildModule>()\n    .AddModule<TestModule>()\n    .AddModule<DeployModule>();\n\n// Configure options directly\nbuilder.Options.ExecutionMode = ExecutionMode.StopOnFirstException;\n\n// Two-step build and run\nawait builder.Build().RunAsync();\n'})}),"\n",(0,l.jsx)(n.h3,{id:"key-differences",children:"Key Differences"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"V2"}),(0,l.jsx)(n.th,{children:"V3"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"PipelineHostBuilder.Create()"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Pipeline.CreateBuilder(args)"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".ConfigureAppConfiguration((ctx, builder) => ...)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"builder.Configuration.Add...()"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".ConfigureServices((ctx, collection) => ...)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"builder.Services.Add...()"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".ConfigurePipelineOptions((ctx, options) => ...)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"builder.Options.Property = value"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:".AddModule<T>()"})," on builder"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"builder.Services.AddModule<T>()"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".ExecutePipelineAsync()"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".Build().RunAsync()"})})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"compatibility-note",children:"Compatibility Note"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"ExecutePipelineAsync()"})," extension method still exists for simpler migrations:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"// This still works in V3\nawait builder.ExecutePipelineAsync();\n"})}),"\n",(0,l.jsx)(n.h2,{id:"module-behavior-changes",children:"Module Behavior Changes"}),"\n",(0,l.jsxs)(n.p,{children:["V2 used virtual property and method overrides to configure module behavior. V3 consolidates these into a fluent ",(0,l.jsx)(n.code,{children:"Configure()"})," builder."]}),"\n",(0,l.jsx)(n.h3,{id:"before-v2-1",children:"Before (V2)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'public class MyModule : Module<string>\n{\n    // Timeout override\n    protected internal override TimeSpan Timeout => TimeSpan.FromMinutes(5);\n\n    // Retry policy override\n    protected override AsyncRetryPolicy<string?> RetryPolicy =>\n        Policy<string?>.Handle<Exception>()\n            .WaitAndRetryAsync(3, i => TimeSpan.FromSeconds(i * i));\n\n    // Skip logic override\n    protected internal override Task<SkipDecision> ShouldSkip(IPipelineContext context)\n    {\n        if (context.Git().Information.BranchName != "main")\n            return Task.FromResult(SkipDecision.Skip("Only runs on main branch"));\n        return Task.FromResult(SkipDecision.DoNotSkip);\n    }\n\n    // Ignore failures override\n    protected internal override Task<bool> ShouldIgnoreFailures(\n        IPipelineContext context, Exception exception) => Task.FromResult(true);\n\n    // Always run override\n    public override ModuleRunType ModuleRunType => ModuleRunType.AlwaysRun;\n\n    // Lifecycle hooks\n    protected internal override Task OnBeforeExecute(IPipelineContext context)\n    {\n        // Pre-execution logic\n        return Task.CompletedTask;\n    }\n\n    protected internal override Task OnAfterExecute(IPipelineContext context)\n    {\n        // Post-execution logic\n        return Task.CompletedTask;\n    }\n\n    protected override async Task<string?> ExecuteAsync(\n        IPipelineContext context, CancellationToken cancellationToken)\n    {\n        // Module logic\n        return "result";\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"after-v3-1",children:"After (V3)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'public class MyModule : Module<string>\n{\n    protected override ModuleConfiguration Configure() => ModuleConfiguration.Create()\n        .WithTimeout(TimeSpan.FromMinutes(5))\n        .WithRetryCount(3)\n        .WithSkipWhen(ctx => ctx.Git().Information.BranchName != "main"\n            ? SkipDecision.Skip("Only runs on main branch")\n            : SkipDecision.DoNotSkip)\n        .WithIgnoreFailures()\n        .WithAlwaysRun()\n        .WithBeforeExecute(ctx => LogStartAsync(ctx))\n        .WithAfterExecute(ctx => LogEndAsync(ctx))\n        .Build();\n\n    protected override async Task<string?> ExecuteAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        // Module logic\n        return "result";\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"migration-mapping",children:"Migration Mapping"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"V2 Override"}),(0,l.jsx)(n.th,{children:"V3 Configure() Method"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"TimeSpan Timeout"})," property"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".WithTimeout(TimeSpan)"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"AsyncRetryPolicy<T?> RetryPolicy"})," property"]}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:".WithRetryCount(int)"})," or ",(0,l.jsx)(n.code,{children:".WithRetryPolicy(IAsyncPolicy)"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Task<SkipDecision> ShouldSkip()"})," method"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".WithSkipWhen(...)"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Task<bool> ShouldIgnoreFailures()"})," method"]}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:".WithIgnoreFailures()"})," or ",(0,l.jsx)(n.code,{children:".WithIgnoreFailuresWhen(...)"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ModuleRunType.AlwaysRun"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".WithAlwaysRun()"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Task OnBeforeExecute()"})," method"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".WithBeforeExecute(...)"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Task OnAfterExecute()"})," method"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".WithAfterExecute(...)"})})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"alternative-lifecycle-hook-overrides",children:"Alternative: Lifecycle Hook Overrides"}),"\n",(0,l.jsx)(n.p,{children:"V3 also supports lifecycle hooks as overridable methods on the module class:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'public class MyModule : Module<string>\n{\n    protected override Task OnBeforeExecuteAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        // Runs before ExecuteAsync\n        return Task.CompletedTask;\n    }\n\n    protected override Task OnAfterExecuteAsync(\n        IModuleContext context,\n        ModuleResult<string> result,\n        CancellationToken cancellationToken)\n    {\n        // Runs after ExecuteAsync (success or failure)\n        return Task.FromResult<ModuleResult<string>?>(null);\n    }\n\n    protected override Task OnSkippedAsync(\n        IModuleContext context,\n        SkipDecision skipDecision,\n        CancellationToken cancellationToken)\n    {\n        // Runs when module is skipped\n        return Task.CompletedTask;\n    }\n\n    protected override Task OnFailedAsync(\n        IModuleContext context,\n        Exception exception,\n        CancellationToken cancellationToken)\n    {\n        // Runs when module fails (before OnAfterExecuteAsync)\n        return Task.CompletedTask;\n    }\n\n    protected override async Task<string?> ExecuteAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        return "result";\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"context-parameter-change",children:"Context Parameter Change"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"ExecuteAsync"})," method now receives ",(0,l.jsx)(n.code,{children:"IModuleContext"})," instead of ",(0,l.jsx)(n.code,{children:"IPipelineContext"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"before-v2-2",children:"Before (V2)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"protected override async Task<string?> ExecuteAsync(\n    IPipelineContext context, CancellationToken cancellationToken)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"after-v3-2",children:"After (V3)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"protected override async Task<string?> ExecuteAsync(\n    IModuleContext context, CancellationToken cancellationToken)\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"IModuleContext"})," extends the pipeline context with module-specific capabilities like ",(0,l.jsx)(n.code,{children:"GetModule<TModule>()"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"command-execution-options",children:"Command Execution Options"}),"\n",(0,l.jsxs)(n.p,{children:["Execution-related properties have been separated from tool-specific options into a dedicated ",(0,l.jsx)(n.code,{children:"CommandExecutionOptions"}),' class. This provides cleaner separation between "what to run" and "how to run it".']}),"\n",(0,l.jsx)(n.h3,{id:"before-v2-3",children:"Before (V2)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'// Execution options were mixed with tool options\nawait context.DotNet().Build(new DotNetBuildOptions\n{\n    Project = "MySolution.sln",\n    Configuration = Configuration.Release,\n    WorkingDirectory = "/path/to/project",        // Was on tool options\n    EnvironmentVariables = new Dictionary<string, string?>\n    {\n        ["CI"] = "true"\n    },\n    ThrowOnNonZeroExitCode = false\n});\n'})}),"\n",(0,l.jsx)(n.h3,{id:"after-v3-3",children:"After (V3)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'// Tool options only contain tool-specific arguments\nawait context.DotNet().Build(\n    new DotNetBuildOptions\n    {\n        ProjectSolution = "MySolution.sln",\n        Configuration = Configuration.Release,\n    },\n    new CommandExecutionOptions                    // Execution options are separate\n    {\n        WorkingDirectory = "/path/to/project",\n        EnvironmentVariables = new Dictionary<string, string?>\n        {\n            ["CI"] = "true"\n        },\n        ThrowOnNonZeroExitCode = false\n    });\n'})}),"\n",(0,l.jsx)(n.h3,{id:"migration-mapping-1",children:"Migration Mapping"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"V2 (on tool options)"}),(0,l.jsxs)(n.th,{children:["V3 (on ",(0,l.jsx)(n.code,{children:"CommandExecutionOptions"}),")"]})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"WorkingDirectory"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"WorkingDirectory"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"EnvironmentVariables"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"EnvironmentVariables"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ThrowOnNonZeroExitCode"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ThrowOnNonZeroExitCode"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CommandLineCredentials"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CommandLineCredentials"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"LoggingSettings"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"LogSettings"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"InputLoggingManipulator"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"InputLoggingManipulator"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"OutputLoggingManipulator"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"OutputLoggingManipulator"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"N/A"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ExecutionTimeout"})," (new)"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"N/A"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"GracefulShutdownTimeout"})," (new)"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"N/A"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Sudo"})," (new)"]})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"benefits",children:"Benefits"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cleaner API"}),": Tool options focus only on tool-specific arguments"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Reusability"}),": Share ",(0,l.jsx)(n.code,{children:"CommandExecutionOptions"})," across multiple commands"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"New features"}),": ",(0,l.jsx)(n.code,{children:"ExecutionTimeout"}),", ",(0,l.jsx)(n.code,{children:"GracefulShutdownTimeout"}),", and ",(0,l.jsx)(n.code,{children:"Sudo"})," options"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"getting-module-results",children:"Getting Module Results"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"GetModule"})," method has moved from the module base class to the context. The result access patterns have also changed to use a discriminated union."]}),"\n",(0,l.jsx)(n.h3,{id:"before-v2-4",children:"Before (V2)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'[DependsOn<BuildModule>]\npublic class DeployModule : Module<DeployResult>\n{\n    protected override async Task<DeployResult?> ExecuteAsync(\n        IPipelineContext context, CancellationToken cancellationToken)\n    {\n        // Method on module base class\n        var buildResult = await GetModule<BuildModule>();\n\n        // Direct value access\n        var artifact = buildResult.Value!.ArtifactPath;\n\n        // Enum-based status check\n        if (buildResult.ModuleResultType == ModuleResultType.Skipped)\n        {\n            return null;\n        }\n\n        if (buildResult.ModuleResultType == ModuleResultType.Failure)\n        {\n            throw new Exception("Build failed", buildResult.Exception);\n        }\n\n        return await Deploy(artifact);\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"after-v3-4",children:"After (V3)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'[DependsOn<BuildModule>]\npublic class DeployModule : Module<DeployResult>\n{\n    protected override async Task<DeployResult?> ExecuteAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        // Method moved to context\n        var buildResult = await context.GetModule<BuildModule>();\n\n        // Option 1: Pattern matching (recommended)\n        return buildResult switch\n        {\n            ModuleResult<BuildOutput>.Success { Value: var output }\n                => await Deploy(output.ArtifactPath),\n            ModuleResult.Skipped { Decision: var skip }\n                => null,\n            ModuleResult.Failure { Exception: var ex }\n                => throw new InvalidOperationException("Build failed", ex),\n            _ => throw new InvalidOperationException("Unexpected result type")\n        };\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"alternative-result-access-patterns",children:"Alternative Result Access Patterns"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'var buildResult = await context.GetModule<BuildModule>();\n\n// Option 1: Pattern matching (recommended - handles all cases)\nreturn buildResult switch\n{\n    ModuleResult<BuildOutput>.Success { Value: var output } => Process(output),\n    ModuleResult.Skipped => null,\n    ModuleResult.Failure { Exception: var ex } => throw ex,\n    _ => null\n};\n\n// Option 2: Match helper method (functional style)\nreturn buildResult.Match(\n    onSuccess: output => Process(output),\n    onFailure: ex => throw new InvalidOperationException("Failed", ex),\n    onSkipped: skip => null\n);\n\n// Option 3: Safe accessor (simplest migration path)\nvar artifact = buildResult.ValueOrDefault?.ArtifactPath;\nif (artifact == null) return null;\nreturn await Deploy(artifact);\n\n// Option 4: Quick status checks\nif (buildResult.IsSuccess)\n{\n    var value = buildResult.ValueOrDefault;\n}\nif (buildResult.IsFailure)\n{\n    var ex = buildResult.ExceptionOrDefault;\n}\nif (buildResult.IsSkipped)\n{\n    var reason = buildResult.SkipDecisionOrDefault?.Reason;\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"key-change-summary",children:"Key Change Summary"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"V2"}),(0,l.jsx)(n.th,{children:"V3"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"await GetModule<T>()"})," (on module)"]}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"await context.GetModule<T>()"})," (on context)"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.Value"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"result.ValueOrDefault"})," or pattern match"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.Exception"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"result.ExceptionOrDefault"})," or pattern match"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.ModuleResultType == ModuleResultType.X"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"result.IsSuccess"}),", ",(0,l.jsx)(n.code,{children:"result.IsFailure"}),", ",(0,l.jsx)(n.code,{children:"result.IsSkipped"})]})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"result-type-quick-reference",children:"Result Type Quick Reference"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Check"}),(0,l.jsx)(n.th,{children:"V2"}),(0,l.jsx)(n.th,{children:"V3"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Is success?"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.ModuleResultType == ModuleResultType.Success"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"result.IsSuccess"})," or ",(0,l.jsx)(n.code,{children:"result is ModuleResult<T>.Success"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Is failure?"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.ModuleResultType == ModuleResultType.Failure"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"result.IsFailure"})," or ",(0,l.jsx)(n.code,{children:"result is ModuleResult.Failure"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Is skipped?"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.ModuleResultType == ModuleResultType.Skipped"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"result.IsSkipped"})," or ",(0,l.jsx)(n.code,{children:"result is ModuleResult.Skipped"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Get value"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.Value"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"result.ValueOrDefault"})," or pattern match"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Get exception"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.Exception"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"result.ExceptionOrDefault"})," or pattern match"]})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"deleted-types-and-members",children:"Deleted Types and Members"}),"\n",(0,l.jsx)(n.p,{children:"The following have been removed in V3:"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Removed"}),(0,l.jsx)(n.th,{children:"Replacement"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"PipelineHostBuilder"})," class"]}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Pipeline.CreateBuilder()"})," returns ",(0,l.jsx)(n.code,{children:"PipelineBuilder"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ModuleBase"})," class"]}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Module<T>"})," (simplified hierarchy)"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ModuleBase<T>"})," class"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Module<T>"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ShouldSkip()"})," method"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Configure().WithSkipWhen()"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ShouldIgnoreFailures()"})," method"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Configure().WithIgnoreFailures()"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ModuleRunType"})," property"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Configure().WithAlwaysRun()"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Timeout"})," property"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Configure().WithTimeout()"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"RetryPolicy"})," property"]}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Configure().WithRetryCount()"})," or ",(0,l.jsx)(n.code,{children:".WithRetryPolicy()"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"GetModule<T>()"})," on module"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"context.GetModule<TModule>()"})})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"new-features-in-v3",children:"New Features in V3"}),"\n",(0,l.jsx)(n.h3,{id:"non-generic-module-classes",children:"Non-Generic Module Classes"}),"\n",(0,l.jsxs)(n.p,{children:["V3 introduces non-generic ",(0,l.jsx)(n.code,{children:"Module"})," and ",(0,l.jsx)(n.code,{children:"SyncModule"})," base classes for modules that perform actions without returning meaningful data. These use the ",(0,l.jsx)(n.code,{children:"None"})," struct internally to represent the absence of a value."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"// Async module that doesn't return data\npublic class DeployModule : Module\n{\n    protected override async Task ExecuteModuleAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        await context.Shell.Command.ExecuteCommandLineTool(...);\n        // No return statement needed\n    }\n}\n\n// Sync module that doesn't return data\npublic class LoggingModule : SyncModule\n{\n    protected override void ExecuteModule(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        context.Logger.LogInformation(\"Pipeline executed at {Time}\", DateTime.UtcNow);\n        // No return statement needed\n    }\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"None"}),' struct represents "nothing" and is semantically equivalent to ',(0,l.jsx)(n.code,{children:"null"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"None value = None.Value;\nvalue.Equals(null);     // true - None equals null\nvalue == default;       // true\nNone? nullable = null;\nnullable == value;      // true - None? and None are always equal\n"})}),"\n",(0,l.jsx)(n.h3,{id:"pipeline-validation",children:"Pipeline Validation"}),"\n",(0,l.jsx)(n.p,{children:"V3 introduces a validation API to catch configuration errors before execution:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'var builder = Pipeline.CreateBuilder(args);\nbuilder.Services.AddModule<MyModule>();\n\n// Option 1: Validate without running\nvar validation = await builder.ValidateAsync();\nif (validation.HasErrors)\n{\n    foreach (var error in validation.Errors)\n    {\n        Console.WriteLine($"[{error.Category}] {error.Message}");\n    }\n    Environment.Exit(1);\n}\n\n// Option 2: BuildAsync validates and throws on error\ntry\n{\n    var pipeline = await builder.BuildAsync();\n    await pipeline.RunAsync();\n}\ncatch (PipelineValidationException ex)\n{\n    foreach (var error in ex.ValidationResult.Errors)\n    {\n        Console.WriteLine($"[{error.Category}] {error.Message}");\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"dynamic-dependencies",children:"Dynamic Dependencies"}),"\n",(0,l.jsx)(n.p,{children:"Declare dependencies programmatically at runtime:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"public class MyModule : Module<string>\n{\n    protected override void DeclareDependencies(IDependencyDeclaration deps)\n    {\n        // Always depend on this module\n        deps.DependsOn<RequiredModule>();\n\n        // Optional dependency (won't fail if not registered)\n        deps.DependsOnOptional<OptionalModule>();\n\n        // Conditional dependency\n        deps.DependsOnIf<ProductionModule>(Environment.IsProduction);\n\n        // Lazy dependency (evaluated later)\n        deps.DependsOnLazy<HeavyModule>();\n    }\n\n    protected override async Task<string?> ExecuteAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        // ...\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"new-dependency-attributes",children:"New Dependency Attributes"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'// Depend on all modules in a category\n[DependsOnModulesInCategory("Build")]\npublic class TestModule : Module<TestResults> { }\n\n// Depend on all modules with a specific tag\n[DependsOnModulesWithTag("database")]\npublic class MigrationModule : Module<bool> { }\n\n// Depend on all modules with a specific attribute\n[DependsOnModulesWithAttribute(typeof(CriticalAttribute))]\npublic class ValidationModule : Module<bool> { }\n'})}),"\n",(0,l.jsx)(n.h3,{id:"conditional-execution-attributes",children:"Conditional Execution Attributes"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"// Run only on specific platforms\n[RunOnWindows]\npublic class WindowsModule : Module<string> { }\n\n[RunOnLinux]\npublic class LinuxModule : Module<string> { }\n\n[RunOnMacOS]\npublic class MacModule : Module<string> { }\n\n// Run ONLY on specific platform (skip on others)\n[RunOnWindowsOnly]\npublic class WindowsOnlyModule : Module<string> { }\n\n// Skip based on custom condition\n[SkipIf(typeof(IsNotMainBranchCondition))]\npublic class MainBranchModule : Module<string> { }\n\n// Combine conditions\n[RunIfAll(typeof(IsCI), typeof(IsMainBranch))]\npublic class CIMainModule : Module<string> { }\n\n[RunIfAny(typeof(IsCI), typeof(ForceRun))]\npublic class FlexibleModule : Module<string> { }\n"})}),"\n",(0,l.jsx)(n.h3,{id:"module-tags",children:"Module Tags"}),"\n",(0,l.jsx)(n.p,{children:"Tag modules for organization and dependency management:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'// Via attributes\n[ModuleTag("critical")]\n[ModuleTag("deployment")]\n[ModuleCategory("Infrastructure")]\npublic class DeployModule : Module<DeployResult> { }\n\n// Via property override\npublic class MyModule : Module<string>\n{\n    public override IReadOnlySet<string> Tags => new HashSet<string> { "critical", "fast" };\n    public override string? Category => "Build";\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"plugin-system",children:"Plugin System"}),"\n",(0,l.jsx)(n.p,{children:"Create reusable pipeline extensions:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'public class MyPlugin : IModularPipelinesPlugin\n{\n    public string Name => "MyPlugin";\n    public int Priority => 0; // Lower runs first\n\n    public void ConfigureServices(IServiceCollection services)\n    {\n        services.AddSingleton<IMyService, MyService>();\n    }\n\n    public void ConfigurePipeline(PipelineBuilder builder)\n    {\n        builder.Services.AddModule<PluginModule>();\n        builder.Options.PrintLogo = false;\n    }\n}\n\n// Register plugin via attribute on assembly\n[assembly: ModularPipelinesPlugin(typeof(MyPlugin))]\n'})}),"\n",(0,l.jsx)(n.h2,{id:"complete-migration-example",children:"Complete Migration Example"}),"\n",(0,l.jsx)(n.h3,{id:"before-v2-5",children:"Before (V2)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'// Program.cs\nawait PipelineHostBuilder.Create()\n    .ConfigureAppConfiguration((ctx, builder) =>\n    {\n        builder.AddJsonFile("appsettings.json");\n    })\n    .ConfigureServices((ctx, services) =>\n    {\n        services.AddModule<BuildModule>()\n            .AddModule<TestModule>()\n            .AddModule<DeployModule>();\n    })\n    .ExecutePipelineAsync();\n\n// BuildModule.cs\npublic class BuildModule : Module<BuildOutput>\n{\n    protected internal override TimeSpan Timeout => TimeSpan.FromMinutes(10);\n\n    protected override async Task<BuildOutput?> ExecuteAsync(\n        IPipelineContext context, CancellationToken cancellationToken)\n    {\n        var result = await context.DotNet().Build(new DotNetBuildOptions());\n        return new BuildOutput(result.StandardOutput);\n    }\n}\n\n// DeployModule.cs\n[DependsOn<BuildModule>]\n[DependsOn<TestModule>]\npublic class DeployModule : Module<bool>\n{\n    protected internal override Task<SkipDecision> ShouldSkip(IPipelineContext context)\n    {\n        if (context.Git().Information.BranchName != "main")\n            return Task.FromResult(SkipDecision.Skip("Not main branch"));\n        return Task.FromResult(SkipDecision.DoNotSkip);\n    }\n\n    protected override async Task<bool> ExecuteAsync(\n        IPipelineContext context, CancellationToken cancellationToken)\n    {\n        var buildResult = await GetModule<BuildModule>();\n\n        if (buildResult.ModuleResultType != ModuleResultType.Success)\n            return false;\n\n        // Deploy using buildResult.Value\n        return true;\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"after-v3-5",children:"After (V3)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'// Program.cs\nvar builder = Pipeline.CreateBuilder(args);\n\nbuilder.Configuration.AddJsonFile("appsettings.json");\n\nbuilder.Services\n    .AddModule<BuildModule>()\n    .AddModule<TestModule>()\n    .AddModule<DeployModule>();\n\nawait builder.Build().RunAsync();\n\n// BuildModule.cs\npublic class BuildModule : Module<BuildOutput>\n{\n    protected override ModuleConfiguration Configure() => ModuleConfiguration.Create()\n        .WithTimeout(TimeSpan.FromMinutes(10))\n        .Build();\n\n    protected override async Task<BuildOutput?> ExecuteAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        var result = await context.DotNet().Build(new DotNetBuildOptions());\n        return new BuildOutput(result.StandardOutput);\n    }\n}\n\n// DeployModule.cs\n[DependsOn<BuildModule>]\n[DependsOn<TestModule>]\npublic class DeployModule : Module<bool>\n{\n    protected override ModuleConfiguration Configure() => ModuleConfiguration.Create()\n        .WithSkipWhen(ctx => ctx.Git().Information.BranchName != "main"\n            ? SkipDecision.Skip("Not main branch")\n            : SkipDecision.DoNotSkip)\n        .Build();\n\n    protected override async Task<bool> ExecuteAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        var buildResult = await context.GetModule<BuildModule>();\n\n        if (buildResult is not ModuleResult<BuildOutput>.Success { Value: var output })\n            return false;\n\n        // Deploy using output\n        return true;\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"breaking-api-reference",children:"Breaking API Reference"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"V2 API"}),(0,l.jsx)(n.th,{children:"V3 API"}),(0,l.jsx)(n.th,{children:"Notes"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"PipelineHostBuilder.Create()"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Pipeline.CreateBuilder(args)"})}),(0,l.jsx)(n.td,{children:"Pass command-line args"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".ExecutePipelineAsync()"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".Build().RunAsync()"})}),(0,l.jsx)(n.td,{children:"Two-step, or use extension"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".ConfigureAppConfiguration(...)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"builder.Configuration"})}),(0,l.jsx)(n.td,{children:"Direct access"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".ConfigureServices(...)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"builder.Services"})}),(0,l.jsx)(n.td,{children:"Direct access"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:".ConfigurePipelineOptions(...)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"builder.Options"})}),(0,l.jsx)(n.td,{children:"Direct access"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"IPipelineContext"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"IModuleContext"})}),(0,l.jsx)(n.td,{children:"In ExecuteAsync signature"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"GetModule<T>()"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"context.GetModule<T>()"})}),(0,l.jsx)(n.td,{children:"Method moved to context"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.Value"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.ValueOrDefault"})}),(0,l.jsx)(n.td,{children:"Or use pattern matching"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.ModuleResultType"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"result.IsSuccess/IsFailure/IsSkipped"})}),(0,l.jsx)(n.td,{children:"Or pattern match"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ShouldSkip()"})," override"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Configure().WithSkipWhen()"})}),(0,l.jsx)(n.td,{children:"Fluent builder"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ShouldIgnoreFailures()"})," override"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Configure().WithIgnoreFailures()"})}),(0,l.jsx)(n.td,{children:"Fluent builder"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Timeout"})," property override"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Configure().WithTimeout()"})}),(0,l.jsx)(n.td,{children:"Fluent builder"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"RetryPolicy"})," property override"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Configure().WithRetryCount()"})}),(0,l.jsx)(n.td,{children:"Fluent builder"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"ModuleRunType"})," override"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Configure().WithAlwaysRun()"})}),(0,l.jsx)(n.td,{children:"Fluent builder"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"OnBeforeExecute()"})," override"]}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Configure().WithBeforeExecute()"})," or ",(0,l.jsx)(n.code,{children:"OnBeforeExecuteAsync()"})]}),(0,l.jsx)(n.td,{children:"Either approach"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"OnAfterExecute()"})," override"]}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Configure().WithAfterExecute()"})," or ",(0,l.jsx)(n.code,{children:"OnAfterExecuteAsync()"})]}),(0,l.jsx)(n.td,{children:"Either approach"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"options.WorkingDirectory"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CommandExecutionOptions.WorkingDirectory"})}),(0,l.jsx)(n.td,{children:"Separate parameter"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"options.EnvironmentVariables"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CommandExecutionOptions.EnvironmentVariables"})}),(0,l.jsx)(n.td,{children:"Separate parameter"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"options.ThrowOnNonZeroExitCode"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CommandExecutionOptions.ThrowOnNonZeroExitCode"})}),(0,l.jsx)(n.td,{children:"Separate parameter"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"llmai-migration-reference",children:"LLM/AI Migration Reference"}),"\n",(0,l.jsx)(n.p,{children:"This section provides structured data optimized for AI assistants helping with code migration."}),"\n",(0,l.jsx)(n.h3,{id:"complete-api-transformation-map",children:"Complete API Transformation Map"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'# Entry Point Changes\n- old: "PipelineHostBuilder.Create()"\n  new: "Pipeline.CreateBuilder(args)"\n\n- old: ".ExecutePipelineAsync()"\n  new: ".Build().RunAsync()"\n\n- old: ".ConfigureAppConfiguration((context, builder) => { ... })"\n  new: "builder.Configuration.Add...()"\n\n- old: ".ConfigureServices((context, collection) => { ... })"\n  new: "builder.Services.Add...()"\n\n- old: ".ConfigurePipelineOptions((context, options) => { ... })"\n  new: "builder.Options.PropertyName = value"\n\n# Context Parameter\n- old: "IPipelineContext context"\n  new: "IModuleContext context"\n  scope: "ExecuteAsync method signature"\n\n# Module Result Access\n- old: "await GetModule<TModule>()"\n  new: "await context.GetModule<TModule>()"\n\n- old: "result.Value"\n  new: "result.ValueOrDefault"\n\n- old: "result.Exception"\n  new: "result.ExceptionOrDefault"\n\n- old: "result.ModuleResultType == ModuleResultType.Success"\n  new: "result.IsSuccess"\n\n- old: "result.ModuleResultType == ModuleResultType.Failure"\n  new: "result.IsFailure"\n\n- old: "result.ModuleResultType == ModuleResultType.Skipped"\n  new: "result.IsSkipped"\n\n# Module Configuration (property overrides \u2192 fluent builder)\n- old: "protected internal override TimeSpan Timeout => ..."\n  new: "Configure().WithTimeout(TimeSpan)"\n\n- old: "protected override AsyncRetryPolicy<T?> RetryPolicy => ..."\n  new: "Configure().WithRetryCount(int)"\n\n- old: "protected internal override Task<SkipDecision> ShouldSkip(...)"\n  new: "Configure().WithSkipWhen(Func<IModuleContext, SkipDecision>)"\n\n- old: "protected internal override Task<bool> ShouldIgnoreFailures(...)"\n  new: "Configure().WithIgnoreFailures()"\n\n- old: "public override ModuleRunType ModuleRunType => ModuleRunType.AlwaysRun"\n  new: "Configure().WithAlwaysRun()"\n\n- old: "protected internal override Task OnBeforeExecute(IPipelineContext context)"\n  new: "Configure().WithBeforeExecute(...) or OnBeforeExecuteAsync(...)"\n\n- old: "protected internal override Task OnAfterExecute(IPipelineContext context)"\n  new: "Configure().WithAfterExecute(...) or OnAfterExecuteAsync(...)"\n\n# Command Execution Options (moved from tool options to separate parameter)\n- old: "new DotNetBuildOptions { WorkingDirectory = path }"\n  new: "new DotNetBuildOptions { }, new CommandExecutionOptions { WorkingDirectory = path }"\n\n- old: "new DotNetBuildOptions { EnvironmentVariables = dict }"\n  new: "new DotNetBuildOptions { }, new CommandExecutionOptions { EnvironmentVariables = dict }"\n\n- old: "new DotNetBuildOptions { ThrowOnNonZeroExitCode = false }"\n  new: "new DotNetBuildOptions { }, new CommandExecutionOptions { ThrowOnNonZeroExitCode = false }"\n\n# Non-generic modules (V3 addition)\n- old: "public class MyModule : Module<IDictionary<string, object>>"\n  new: "public class MyModule : Module"\n  note: "For modules that don\'t return data"\n\n- old: "protected override async Task<IDictionary<string, object>?> ExecuteAsync(...)"\n  new: "protected override async Task ExecuteModuleAsync(...)"\n  note: "No return statement needed"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"common-compiler-errors-and-fixes",children:"Common Compiler Errors and Fixes"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Error"}),(0,l.jsx)(n.th,{children:"Cause"}),(0,l.jsx)(n.th,{children:"Fix"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CS0246: 'PipelineHostBuilder' could not be found"})}),(0,l.jsx)(n.td,{children:"Class renamed"}),(0,l.jsxs)(n.td,{children:["Change to ",(0,l.jsx)(n.code,{children:"Pipeline.CreateBuilder(args)"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CS0246: 'IPipelineContext' could not be found"})}),(0,l.jsx)(n.td,{children:"Interface renamed"}),(0,l.jsxs)(n.td,{children:["Change to ",(0,l.jsx)(n.code,{children:"IModuleContext"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CS1061: 'Module' does not contain 'GetModule'"})}),(0,l.jsx)(n.td,{children:"Method moved"}),(0,l.jsxs)(n.td,{children:["Change ",(0,l.jsx)(n.code,{children:"GetModule<T>()"})," to ",(0,l.jsx)(n.code,{children:"context.GetModule<T>()"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CS0117: 'ModuleResult' does not contain 'Value'"})}),(0,l.jsx)(n.td,{children:"Property renamed"}),(0,l.jsxs)(n.td,{children:["Change ",(0,l.jsx)(n.code,{children:".Value"})," to ",(0,l.jsx)(n.code,{children:".ValueOrDefault"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CS0117: 'ModuleResult' does not contain 'Exception'"})}),(0,l.jsx)(n.td,{children:"Property renamed"}),(0,l.jsxs)(n.td,{children:["Change ",(0,l.jsx)(n.code,{children:".Exception"})," to ",(0,l.jsx)(n.code,{children:".ExceptionOrDefault"})]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CS0115: 'ShouldSkip': no suitable method found to override"})}),(0,l.jsx)(n.td,{children:"Method removed"}),(0,l.jsxs)(n.td,{children:["Use ",(0,l.jsx)(n.code,{children:"Configure().WithSkipWhen()"})," instead"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CS0115: 'Timeout': no suitable method found to override"})}),(0,l.jsx)(n.td,{children:"Property removed"}),(0,l.jsxs)(n.td,{children:["Use ",(0,l.jsx)(n.code,{children:"Configure().WithTimeout()"})," instead"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CS0115: 'RetryPolicy': no suitable method found to override"})}),(0,l.jsx)(n.td,{children:"Property removed"}),(0,l.jsxs)(n.td,{children:["Use ",(0,l.jsx)(n.code,{children:"Configure().WithRetryCount()"})," instead"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CS1061: 'DotNetBuildOptions' does not contain 'WorkingDirectory'"})}),(0,l.jsx)(n.td,{children:"Property moved"}),(0,l.jsxs)(n.td,{children:["Pass ",(0,l.jsx)(n.code,{children:"CommandExecutionOptions"})," as second parameter"]})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"regex-patterns-for-automated-migration",children:"Regex Patterns for Automated Migration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-regex",children:"# Entry point\ns/PipelineHostBuilder\\.Create\\(\\)/Pipeline.CreateBuilder(args)/g\n\n# Context parameter in ExecuteAsync\ns/IPipelineContext\\s+context/IModuleContext context/g\n\n# GetModule calls\ns/await\\s+GetModule<(\\w+)>\\(\\)/await context.GetModule<$1>()/g\ns/GetModule<(\\w+)>\\(\\)/context.GetModule<$1>()/g\n\n# Result property access\ns/\\.Value(?![a-zA-Z])/\\.ValueOrDefault/g\ns/\\.Exception(?![a-zA-Z])/\\.ExceptionOrDefault/g\n\n# Result type checks\ns/\\.ModuleResultType\\s*==\\s*ModuleResultType\\.Success/\\.IsSuccess/g\ns/\\.ModuleResultType\\s*==\\s*ModuleResultType\\.Failure/\\.IsFailure/g\ns/\\.ModuleResultType\\s*==\\s*ModuleResultType\\.Skipped/\\.IsSkipped/g\n"})}),"\n",(0,l.jsx)(n.h3,{id:"v3-module-template",children:"V3 Module Template"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"// Async module WITH return value\npublic class MyModule : Module<MyResult>\n{\n    protected override ModuleConfiguration Configure() => ModuleConfiguration.Create()\n        .WithTimeout(TimeSpan.FromMinutes(5))\n        // Add other configuration as needed\n        .Build();\n\n    protected override async Task<MyResult?> ExecuteAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        // Implementation\n        return new MyResult();\n    }\n}\n\n// Async module WITHOUT return value\npublic class MyActionModule : Module\n{\n    protected override async Task ExecuteModuleAsync(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        // Implementation - no return needed\n    }\n}\n\n// Sync module WITHOUT return value\npublic class MySyncModule : SyncModule\n{\n    protected override void ExecuteModule(\n        IModuleContext context, CancellationToken cancellationToken)\n    {\n        // Implementation - no return needed\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"v3-result-handling-patterns",children:"V3 Result Handling Patterns"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"// Pattern 1: Pattern matching (recommended)\nvar result = await context.GetModule<BuildModule>();\nreturn result switch\n{\n    ModuleResult<BuildOutput>.Success { Value: var output } => Process(output),\n    ModuleResult.Skipped => null,\n    ModuleResult.Failure { Exception: var ex } => throw ex,\n    _ => null\n};\n\n// Pattern 2: Match helper\nvar result = await context.GetModule<BuildModule>();\nreturn result.Match(\n    onSuccess: output => Process(output),\n    onFailure: ex => throw ex,\n    onSkipped: skip => null\n);\n\n// Pattern 3: Simple property access (easiest migration)\nvar result = await context.GetModule<BuildModule>();\nif (result.IsSuccess)\n{\n    var value = result.ValueOrDefault;\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"v3-command-execution-pattern",children:"V3 Command Execution Pattern"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'// Tool-specific options separate from execution options\nawait context.DotNet().Build(\n    new DotNetBuildOptions\n    {\n        ProjectSolution = "MySolution.sln",\n        Configuration = "Release",\n    },\n    new CommandExecutionOptions\n    {\n        WorkingDirectory = "/path/to/project",\n        EnvironmentVariables = new Dictionary<string, string?>\n        {\n            ["CI"] = "true"\n        },\n        ThrowOnNonZeroExitCode = false,\n        ExecutionTimeout = TimeSpan.FromMinutes(10)\n    });\n'})}),"\n",(0,l.jsx)(n.h3,{id:"keywords-for-search",children:"Keywords for Search"}),"\n",(0,l.jsx)(n.p,{children:"ModularPipelines, V3 migration, PipelineHostBuilder, Pipeline.CreateBuilder, IPipelineContext, IModuleContext, GetModule, ModuleResult, ValueOrDefault, ExceptionOrDefault, IsSuccess, IsFailure, IsSkipped, ModuleConfiguration, Configure, WithTimeout, WithRetryCount, WithSkipWhen, WithIgnoreFailures, WithAlwaysRun, CommandExecutionOptions, WorkingDirectory, EnvironmentVariables, Module non-generic, SyncModule, None struct, ExecuteModuleAsync, ExecuteModule"}),"\n",(0,l.jsx)(n.h2,{id:"getting-help",children:"Getting Help"}),"\n",(0,l.jsx)(n.p,{children:"If you encounter issues migrating to V3:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Check the ",(0,l.jsx)(n.a,{href:"https://github.com/thomhurst/ModularPipelines/issues",children:"GitHub Issues"})," for known migration problems"]}),"\n",(0,l.jsxs)(n.li,{children:["Review the ",(0,l.jsx)(n.a,{href:"https://github.com/thomhurst/ModularPipelines/tree/main/src/ModularPipelines.Examples",children:"Examples"})," for V3 patterns"]}),"\n",(0,l.jsxs)(n.li,{children:["Open a new issue with the ",(0,l.jsx)(n.code,{children:"migration"})," label if you're stuck"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>d});var t=i(6540);const l={},r=t.createContext(l);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);