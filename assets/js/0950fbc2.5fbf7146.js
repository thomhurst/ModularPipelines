"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[2506],{408:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>s,default:()=>c,frontMatter:()=>d,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"how-to/pipeline-host","title":"Pipeline Host","description":"To begin creating your pipeline, use the Pipeline.CreateBuilder() method.","source":"@site/docs/how-to/pipeline-host.md","sourceDirName":"how-to","slug":"/how-to/pipeline-host","permalink":"/ModularPipelines/docs/how-to/pipeline-host","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Pipeline Host","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"How-To","permalink":"/ModularPipelines/docs/category/how-to"},"next":{"title":"Defining Modules","permalink":"/ModularPipelines/docs/how-to/defining-modules"}}');var o=i(4848),l=i(8453);const d={title:"Pipeline Host",sidebar_position:1},s="Pipeline Host",t={},a=[{value:"Basic Example",id:"basic-example",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Registering Modules",id:"registering-modules",level:2},{value:"Conditional Registration",id:"conditional-registration",level:3},{value:"Pipeline Options",id:"pipeline-options",level:2},{value:"Building and Running",id:"building-and-running",level:2},{value:"With Validation",id:"with-validation",level:3},{value:"Validate Without Running",id:"validate-without-running",level:3},{value:"Complete Example",id:"complete-example",level:2},{value:"Hooks and Requirements",id:"hooks-and-requirements",level:2},{value:"Extension Methods",id:"extension-methods",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"pipeline-host",children:"Pipeline Host"})}),"\n",(0,o.jsxs)(n.p,{children:["To begin creating your pipeline, use the ",(0,o.jsx)(n.code,{children:"Pipeline.CreateBuilder()"})," method."]}),"\n",(0,o.jsxs)(n.p,{children:["The recommended approach is to create a console application and use this builder in your ",(0,o.jsx)(n.code,{children:"Program.cs"})," file."]}),"\n",(0,o.jsx)(n.p,{children:"The pipeline builder follows the ASP.NET Core minimal API pattern, providing direct access to:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Configuration"})," - for adding configuration sources"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Services"})," - for dependency injection"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Options"})," - for pipeline behavior settings"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Environment"})," - for host environment information"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"basic-example",children:"Basic Example"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"var builder = Pipeline.CreateBuilder(args);\n\nbuilder.Services\n    .AddModule<BuildModule>()\n    .AddModule<TestModule>()\n    .AddModule<DeployModule>();\n\nawait builder.Build().RunAsync();\n"})}),"\n",(0,o.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsxs)(n.p,{children:["Add configuration sources directly via the ",(0,o.jsx)(n.code,{children:"Configuration"})," property:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'var builder = Pipeline.CreateBuilder(args);\n\nbuilder.Configuration\n    .AddJsonFile("appsettings.json", optional: false)\n    .AddJsonFile($"appsettings.{builder.Environment.EnvironmentName}.json", optional: true)\n    .AddUserSecrets<Program>()\n    .AddEnvironmentVariables();\n\n// Use configuration in services\nbuilder.Services.Configure<MySettings>(builder.Configuration.GetSection("MySettings"));\n'})}),"\n",(0,o.jsx)(n.h2,{id:"registering-modules",children:"Registering Modules"}),"\n",(0,o.jsxs)(n.p,{children:["Modules can be registered directly on the ",(0,o.jsx)(n.code,{children:"Services"})," collection:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"var builder = Pipeline.CreateBuilder(args);\n\n// Register modules\nbuilder.Services\n    .AddModule<Module1>()\n    .AddModule<Module2>()\n    .AddModule<Module3>();\n\n// Or register multiple at once\nbuilder.AddModules<Module1, Module2, Module3>();\n"})}),"\n",(0,o.jsx)(n.h3,{id:"conditional-registration",children:"Conditional Registration"}),"\n",(0,o.jsxs)(n.p,{children:["Use ",(0,o.jsx)(n.code,{children:"builder.Environment"})," or ",(0,o.jsx)(n.code,{children:"builder.Configuration"})," for conditional module registration:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'var builder = Pipeline.CreateBuilder(args);\n\nbuilder.Configuration.AddJsonFile("appsettings.json");\n\n// Environment-based registration\nif (builder.Environment.IsDevelopment())\n{\n    builder.Services.AddModule<DevOnlyModule>();\n}\n\n// Configuration-based registration\nif (builder.Configuration.GetValue<bool>("EnableExtraModules"))\n{\n    builder.Services.AddModule<OptionalModule>();\n}\n\nbuilder.Services.AddModule<AlwaysRunModule>();\n'})}),"\n",(0,o.jsx)(n.h2,{id:"pipeline-options",children:"Pipeline Options"}),"\n",(0,o.jsxs)(n.p,{children:["Configure pipeline behavior via the ",(0,o.jsx)(n.code,{children:"Options"})," property:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'var builder = Pipeline.CreateBuilder(args);\n\n// Execution mode\nbuilder.Options.ExecutionMode = ExecutionMode.StopOnFirstException;\n\n// Category filtering\nbuilder.Options.RunOnlyCategories = ["Build", "Test"];\nbuilder.Options.IgnoreCategories = ["Experimental"];\n\n// Display options\nbuilder.Options.ShowProgressInConsole = true;\nbuilder.Options.PrintResults = true;\nbuilder.Options.PrintLogo = true;\n\n// Concurrency settings\nbuilder.Options.Concurrency = new ConcurrencyOptions\n{\n    MaxParallelModules = 4\n};\n'})}),"\n",(0,o.jsx)(n.h2,{id:"building-and-running",children:"Building and Running"}),"\n",(0,o.jsx)(n.p,{children:"The pipeline follows a two-step build-then-run pattern:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"var builder = Pipeline.CreateBuilder(args);\nbuilder.Services.AddModule<MyModule>();\n\n// Step 1: Build the pipeline\nvar pipeline = builder.Build();\n\n// Step 2: Run it\nvar summary = await pipeline.RunAsync();\n\n// Check results\nif (summary.Status == PipelineStatus.Failed)\n{\n    Environment.Exit(1);\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"with-validation",children:"With Validation"}),"\n",(0,o.jsxs)(n.p,{children:["Use ",(0,o.jsx)(n.code,{children:"BuildAsync()"})," to validate the pipeline configuration before running:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'var builder = Pipeline.CreateBuilder(args);\nbuilder.Services.AddModule<MyModule>();\n\ntry\n{\n    // BuildAsync validates and throws PipelineValidationException on errors\n    var pipeline = await builder.BuildAsync();\n    await pipeline.RunAsync();\n}\ncatch (PipelineValidationException ex)\n{\n    foreach (var error in ex.ValidationResult.Errors)\n    {\n        Console.WriteLine($"[{error.Category}] {error.Message}");\n    }\n    Environment.Exit(1);\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"validate-without-running",children:"Validate Without Running"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'var builder = Pipeline.CreateBuilder(args);\nbuilder.Services.AddModule<MyModule>();\n\nvar validation = await builder.ValidateAsync();\nif (validation.HasErrors)\n{\n    foreach (var error in validation.Errors)\n    {\n        Console.WriteLine($"Validation Error: {error.Message}");\n    }\n    Environment.Exit(1);\n}\n\nawait builder.Build().RunAsync();\n'})}),"\n",(0,o.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'using Microsoft.Extensions.Configuration;\nusing Microsoft.Extensions.DependencyInjection;\nusing ModularPipelines;\nusing ModularPipelines.Extensions;\nusing ModularPipelines.Options;\n\nvar builder = Pipeline.CreateBuilder(args);\n\n// Configuration\nbuilder.Configuration\n    .AddJsonFile("appsettings.json")\n    .AddUserSecrets<Program>()\n    .AddEnvironmentVariables();\n\n// Options\nbuilder.Options.ExecutionMode = ExecutionMode.StopOnFirstException;\nbuilder.Options.IgnoreCategories = ["Experimental"];\n\n// Services\nbuilder.Services.Configure<NuGetSettings>(builder.Configuration.GetSection("NuGet"));\nbuilder.Services.Configure<PublishSettings>(builder.Configuration.GetSection("Publish"));\n\n// Conditional modules\nif (builder.Environment.IsDevelopment())\n{\n    builder.Services\n        .AddModule<LocalBuildModule>()\n        .AddModule<LocalTestModule>();\n}\nelse\n{\n    builder.Services\n        .AddModule<CIBuildModule>()\n        .AddModule<CITestModule>()\n        .AddModule<PublishModule>();\n}\n\n// Always-registered modules\nbuilder.Services\n    .AddModule<CleanupModule>()\n    .AddModule<ReportModule>();\n\n// Run\nawait builder.Build().RunAsync();\n'})}),"\n",(0,o.jsx)(n.h2,{id:"hooks-and-requirements",children:"Hooks and Requirements"}),"\n",(0,o.jsx)(n.p,{children:"Register global hooks and pipeline requirements:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"var builder = Pipeline.CreateBuilder(args);\n\n// Global hooks (run before/after all modules)\nbuilder.AddPipelineGlobalHooks<MyGlobalHooks>();\n\n// Module hooks (run before/after each module)\nbuilder.AddPipelineModuleHooks<MyModuleHooks>();\n\n// Requirements (validated before pipeline starts)\nbuilder.AddRequirement<DotNetSdkRequirement>();\nbuilder.AddRequirement<GitRequirement>();\n"})}),"\n",(0,o.jsx)(n.h2,{id:"extension-methods",children:"Extension Methods"}),"\n",(0,o.jsx)(n.p,{children:"For a more fluent API, extension methods are available:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"var builder = Pipeline.CreateBuilder(args);\n\nawait builder\n    .ConfigureServices(services =>\n    {\n        services.AddModule<Module1>();\n        services.AddModule<Module2>();\n    })\n    .ConfigurePipelineOptions(options =>\n    {\n        options.ExecutionMode = ExecutionMode.StopOnFirstException;\n    })\n    .ExecutePipelineAsync();\n"})})]})}function c(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>s});var r=i(6540);const o={},l=r.createContext(o);function d(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);