"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[5911],{4345:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"how-to/migrating-to-v2-options","title":"Migrating to v2 CommandLineToolOptions","description":"ModularPipelines v2 introduces a redesigned CommandLineToolOptions architecture that provides better type safety, compile-time validation, and IntelliSense support.","source":"@site/docs/how-to/migrating-to-v2-options.md","sourceDirName":"how-to","slug":"/how-to/migrating-to-v2-options","permalink":"/ModularPipelines/docs/how-to/migrating-to-v2-options","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Migrating to v2 CommandLineToolOptions"},"sidebar":"tutorialSidebar","previous":{"title":"Inheriting","permalink":"/ModularPipelines/docs/how-to/inheriting"},"next":{"title":"Parallelization","permalink":"/ModularPipelines/docs/how-to/parallelization"}}');var t=i(4848),o=i(8453);const r={title:"Migrating to v2 CommandLineToolOptions"},l="Migrating to v2 CommandLineToolOptions",a={},c=[{value:"What&#39;s Changed",id:"whats-changed",level:2},{value:"Tool Definition via Attributes",id:"tool-definition-via-attributes",level:3},{value:"Subcommand Definition",id:"subcommand-definition",level:3},{value:"Typed Positional Arguments",id:"typed-positional-arguments",level:3},{value:"Per-Subcommand Options Classes",id:"per-subcommand-options-classes",level:3},{value:"Migration Steps",id:"migration-steps",level:2},{value:"Escape Hatch",id:"escape-hatch",level:2},{value:"Source Generator Validation",id:"source-generator-validation",level:2},{value:"Migration Analyzer",id:"migration-analyzer",level:2},{value:"Benefits",id:"benefits",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"migrating-to-v2-commandlinetooloptions",children:"Migrating to v2 CommandLineToolOptions"})}),"\n",(0,t.jsxs)(n.p,{children:["ModularPipelines v2 introduces a redesigned ",(0,t.jsx)(n.code,{children:"CommandLineToolOptions"})," architecture that provides better type safety, compile-time validation, and IntelliSense support."]}),"\n",(0,t.jsx)(n.h2,{id:"whats-changed",children:"What's Changed"}),"\n",(0,t.jsx)(n.h3,{id:"tool-definition-via-attributes",children:"Tool Definition via Attributes"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Before (v1):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'public abstract record GitOptions() : CommandLineToolOptions("git");\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"After (v2):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'[CliTool("git")]\npublic abstract partial record GitOptions : CommandLineToolOptions;\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The tool name is now declared via the ",(0,t.jsx)(n.code,{children:"[CliTool]"})," attribute on the base class, not a constructor parameter."]}),"\n",(0,t.jsx)(n.h3,{id:"subcommand-definition",children:"Subcommand Definition"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Before (v1):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"// Inheritance implied the subcommand, but it wasn't explicit\npublic record GitAddOptions() : GitOptions;\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"After (v2):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'[CliSubCommand("add")]\npublic partial record GitAddOptions : GitOptions;\n'})}),"\n",(0,t.jsx)(n.p,{children:"Nested subcommands use multiple strings:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'[CliSubCommand("remote", "set-url")]\npublic partial record GitRemoteSetUrlOptions : GitOptions;\n'})}),"\n",(0,t.jsx)(n.h3,{id:"typed-positional-arguments",children:"Typed Positional Arguments"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Before (v1):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Dynamic values required the Arguments escape hatch\nnew GitRevParseOptions { Arguments = ["HEAD"] }\nnew GitDiffOptions { Arguments = ["origin/main"] }\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"After (v2):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Typed properties with [CliArgument] attribute\nnew GitRevParseOptions { Committish = "HEAD" }\nnew GitDiffOptions { BaseRef = "origin/main" }\n'})}),"\n",(0,t.jsx)(n.h3,{id:"per-subcommand-options-classes",children:"Per-Subcommand Options Classes"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Before (v1):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Same generic class used for different subcommands\nnew GitRemoteOptions { Arguments = ["set-url", "origin", url] }\nnew GitRemoteOptions { Arguments = ["get-url", "origin"] }\nnew GitRemoteOptions { Arguments = ["show", "origin"] }\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"After (v2):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Separate typed classes for each subcommand\nnew GitRemoteSetUrlOptions { Remote = "origin", NewUrl = url }\nnew GitRemoteGetUrlOptions { Remote = "origin" }\nnew GitRemoteShowOptions { Remote = "origin" }\n'})}),"\n",(0,t.jsx)(n.h2,{id:"migration-steps",children:"Migration Steps"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:["Add ",(0,t.jsx)(n.code,{children:"partial"})," keyword"]})," to any custom options classes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Remove constructor parameters"})," - tool name comes from ",(0,t.jsx)(n.code,{children:"[CliTool]"})," attribute"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:["Replace ",(0,t.jsx)(n.code,{children:"Arguments"})," usage"]})," with typed positional argument properties"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use granular options classes"})," for subcommands"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"escape-hatch",children:"Escape Hatch"}),"\n",(0,t.jsxs)(n.p,{children:["For tools without typed options, use ",(0,t.jsx)(n.code,{children:"GenericCommandLineToolOptions"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'await command.ExecuteCommandLineTool(new GenericCommandLineToolOptions("dotnet-gitversion")\n{\n    Arguments = ["/output", "json"]\n});\n'})}),"\n",(0,t.jsx)(n.h2,{id:"source-generator-validation",children:"Source Generator Validation"}),"\n",(0,t.jsx)(n.p,{children:"The new source generator validates your options classes at compile time:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"MP0001"}),": Options class must be marked ",(0,t.jsx)(n.code,{children:"partial"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"MP0002"}),": Options class missing ",(0,t.jsx)(n.code,{children:"[CliTool]"})," in inheritance chain"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"MP0003"}),": Duplicate ",(0,t.jsx)(n.code,{children:"[CliArgument]"})," positions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"MP0004"}),": Property has no CLI attribute (warning)"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"migration-analyzer",children:"Migration Analyzer"}),"\n",(0,t.jsxs)(n.p,{children:["The analyzer ",(0,t.jsx)(n.strong,{children:"MP0010"})," will warn when you use the deprecated ",(0,t.jsx)(n.code,{children:"Arguments"})," property on typed options classes, helping you identify code that needs migration."]}),"\n",(0,t.jsx)(n.h2,{id:"benefits",children:"Benefits"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type Safety"}),": Compile-time validation catches errors before runtime"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"IntelliSense"}),": Full IDE support for discovering available options"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No Reflection"}),": Generated ",(0,t.jsx)(n.code,{children:"Build()"})," methods eliminate runtime reflection"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Clear Intent"}),": Per-subcommand classes make code self-documenting"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var s=i(6540);const t={},o=s.createContext(t);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);